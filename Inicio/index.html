<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EducaSync - Panel de Administración</title>
    <!-- Tailwind CSS para un diseño rápido y moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons (versión estándar, no-React) -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <!-- Google Fonts para una tipografía más profesional -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .sidebar {
            background-color: #111827;
        }
        .logo-font {
            font-family: 'Inter', sans-serif;
        }
        /* Estilos para el scroll */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* Estilos específicos para el calendario */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        .calendar-day {
            min-height: 120px;
        }
        .day-event {
            font-size: 0.75rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Selector de Rol (Para Simulación) -->
    <div class="bg-gray-800 text-white p-2 text-center text-sm">
        <span class="font-semibold">Vista de Simulación:</span>
        <select id="role-switcher" class="bg-gray-700 text-white rounded-md p-1 ml-2">
            <option value="directivo">Directivo</option>
            <option value="secretaria">Secretaria</option>
        </select>
    </div>

    <div id="directivo-view-container" class="flex h-full">
        <!-- Barra lateral de navegación (Directivo) -->
        <aside class="sidebar w-64 text-gray-100 flex-shrink-0">
            <div class="p-6">
                <div class="flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-400"><path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z"/><circle cx="12" cy="10" r="3"/></svg>
                    <h1 class="text-2xl font-bold ml-2 logo-font">EducaSync</h1>
                </div>
            </div>
            <nav class="mt-6">
                <a href="#" class="nav-link flex items-center py-3 px-6 text-gray-300 hover:bg-gray-700 hover:text-white transition duration-200" data-view="dashboard">
                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i><span class="ml-4">Inicio</span>
                </a>
                <a href="#" class="nav-link flex items-center py-3 px-6 text-gray-300 hover:bg-gray-700 hover:text-white transition duration-200" data-view="calendar">
                    <i data-lucide="calendar" class="w-5 h-5"></i><span class="ml-4">Calendario</span>
                </a>
                <a href="#" class="nav-link flex items-center py-3 px-6 text-gray-300 hover:bg-gray-700 hover:text-white transition duration-200" data-view="eventos">
                    <i data-lucide="bell" class="w-5 h-5"></i><span class="ml-4">Eventos</span>
                </a>
                <a href="#" class="nav-link flex items-center py-3 px-6 text-gray-300 hover:bg-gray-700 hover:text-white transition duration-200" data-view="cursos">
                     <i data-lucide="book-marked" class="w-5 h-5"></i><span class="ml-4">Cursos</span>
                </a>
                <a href="#" class="nav-link flex items-center py-3 px-6 text-gray-300 hover:bg-gray-700 hover:text-white transition duration-200" data-view="aulas">
                    <i data-lucide="school" class="w-5 h-5"></i><span class="ml-4">Info por Curso</span>
                </a>
            </nav>
        </aside>

        <!-- Contenido principal (Directivo) -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="bg-white shadow-sm p-4 flex justify-between items-center">
                 <h2 id="view-title" class="text-2xl font-semibold text-gray-800">Panel de Inicio</h2>
            </header>
            <main id="main-content-directivo" class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-8">
                <!-- Vistas del Directivo se cargarán aquí -->
            </main>
        </div>
    </div>
    
    <!-- Contenido principal (Secretaria) -->
    <div id="secretaria-view-container" class="hidden h-full">
         <main id="main-content-secretaria" class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-8">
            <!-- La vista de calendario de la secretaria se cargará aquí -->
         </main>
    </div>

    <!-- Modal para agregar evento -->
    <div id="event-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl p-8 max-w-lg w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">Agregar Nuevo Evento</h3>
                <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <form id="event-form">
                <input type="hidden" id="event-date">
                <div>
                    <label for="event-title" class="block text-sm font-medium text-gray-700">Título del Evento</label>
                    <input type="text" id="event-title" required class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="mt-4">
                    <label for="event-course" class="block text-sm font-medium text-gray-700">Curso</label>
                    <select id="event-course" required class="mt-1 w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="1-inicial">1° Inicial</option>
                        <option value="2-inicial">2° Inicial</option>
                        <option value="3-tipp">3° TIPP</option>
                        <option value="3-mmo">3° MMO</option>
                        <!-- ... más opciones ... -->
                    </select>
                </div>
                <div class="mt-6 text-right">
                    <button type="submit" class="bg-blue-500 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-600">Guardar Evento</button>
                </div>
            </form>
        </div>
    </div>


    <script type="module">
        // --- Plantillas de Vistas ---
        const directivoDashboardView = `
            <div id="dashboard-view" class="view">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                     <div class="bg-white p-6 rounded-lg shadow-md flex items-center justify-between"><div><p class="text-sm text-gray-500">Total de Cursos</p><p class="text-3xl font-bold text-gray-800">12</p></div><div class="bg-blue-100 p-3 rounded-full"><i data-lucide="book-marked" class="text-blue-500"></i></div></div>
                     <div class="bg-white p-6 rounded-lg shadow-md flex items-center justify-between"><div><p class="text-sm text-gray-500">Aulas Disponibles</p><p class="text-3xl font-bold text-gray-800">8</p></div><div class="bg-green-100 p-3 rounded-full"><i data-lucide="school" class="text-green-500"></i></div></div>
                     <div class="bg-white p-6 rounded-lg shadow-md flex items-center justify-between"><div><p class="text-sm text-gray-500">Próximos Eventos</p><p class="text-3xl font-bold text-gray-800">3</p></div><div class="bg-yellow-100 p-3 rounded-full"><i data-lucide="calendar" class="text-yellow-500"></i></div></div>
                     <div class="bg-white p-6 rounded-lg shadow-md flex items-center justify-between"><div><p class="text-sm text-gray-500">Estudiantes Activos</p><p class="text-3xl font-bold text-gray-800">256</p></div><div class="bg-indigo-100 p-3 rounded-full"><i data-lucide="users" class="text-indigo-500"></i></div></div>
                </div>
            </div>`;

        const calendarViewTemplate = `
            <div id="calendar-view" class="view flex gap-8">
                <!-- Calendario Principal -->
                <div class="bg-white p-6 rounded-xl shadow-lg flex-grow">
                    <div class="flex justify-between items-center mb-6">
                        <button id="prev-month" class="p-2 rounded-full hover:bg-gray-100"><i data-lucide="chevron-left"></i></button>
                        <h3 id="month-year" class="text-xl font-semibold text-gray-700"></h3>
                        <button id="next-month" class="p-2 rounded-full hover:bg-gray-100"><i data-lucide="chevron-right"></i></button>
                    </div>
                    <div class="grid grid-cols-7 gap-2 text-center text-sm text-gray-500 font-semibold mb-2">
                        <div>Dom</div><div>Lun</div><div>Mar</div><div>Mié</div><div>Jue</div><div>Vie</div><div>Sáb</div>
                    </div>
                    <div id="calendar-grid" class="calendar-grid"></div>
                </div>
                <!-- Panel Lateral (Guía de Cursos) -->
                <div id="course-guide-panel" class="w-72 bg-white p-6 rounded-xl shadow-lg">
                    <h4 class="font-semibold text-gray-800 mb-4">Crear Evento para:</h4>
                    <p class="text-sm text-gray-500 mb-4">Seleccione un curso para agregarlo rápidamente al calendario.</p>
                    <div class="space-y-3">
                        <!-- Botones de cursos se insertarán aquí -->
                    </div>
                </div>
            </div>`;
        
        // ... (otras plantillas de vistas como aulas, cursos, eventos) ...

        const App = {
            state: {
                role: 'directivo',
                currentDate: new Date(),
                events: {}, // { '2025-10-09': [{ title: 'Reunión', course: '3-tipp' }] }
            },
            
            init() {
                this.render();
                this.addEventListeners();
            },

            render() {
                const { role } = this.state;
                
                document.getElementById('directivo-view-container').classList.toggle('hidden', role !== 'directivo');
                document.getElementById('secretaria-view-container').classList.toggle('hidden', role !== 'secretaria');

                if (role === 'directivo') {
                    this.switchView('dashboard');
                } else {
                    document.getElementById('main-content-secretaria').innerHTML = calendarViewTemplate;
                    this.renderCalendar();
                    this.renderCourseButtons();
                    this.addCalendarListeners();
                    lucide.createIcons();
                }
            },

            switchView(viewId) {
                let content = '';
                // Simulación de carga de vistas
                if (viewId === 'dashboard') content = directivoDashboardView;
                if (viewId === 'calendar') content = calendarViewTemplate;
                
                document.getElementById('main-content-directivo').innerHTML = content;
                
                if (viewId === 'calendar') {
                    this.renderCalendar();
                    document.getElementById('course-guide-panel').classList.add('hidden'); // Ocultar para directivo
                    this.addCalendarListeners();
                }
                
                lucide.createIcons();
            },

            renderCalendar() {
                const { currentDate, events } = this.state;
                const calendarGrid = document.getElementById('calendar-grid');
                if (!calendarGrid) return;
                
                calendarGrid.innerHTML = '';
                const month = currentDate.getMonth();
                const year = currentDate.getFullYear();

                document.getElementById('month-year').textContent = `${currentDate.toLocaleString('es-ES', { month: 'long' })} ${year}`;

                const firstDayOfMonth = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                // Días vacíos al inicio
                for (let i = 0; i < firstDayOfMonth; i++) {
                    calendarGrid.insertAdjacentHTML('beforeend', '<div></div>');
                }

                // Días del mes
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    const today = new Date();
                    const isToday = day === today.getDate() && month === today.getMonth() && year === today.getFullYear();
                    
                    let dayEventsHTML = '';
                    if (events[dateStr]) {
                        events[dateStr].forEach(event => {
                             dayEventsHTML += `<div class="day-event text-white" style="background-color: #3b82f6;">${event.title}</div>`; // Color de ejemplo
                        });
                    }

                    const dayElement = `
                        <div class="calendar-day border rounded-lg p-2 flex flex-col cursor-pointer hover:bg-gray-50 ${isToday ? 'bg-blue-50 border-blue-200' : 'bg-white'}" data-date="${dateStr}">
                            <span class="font-semibold ${isToday ? 'text-blue-600' : 'text-gray-700'}">${day}</span>
                            <div class="mt-1 flex-grow">${dayEventsHTML}</div>
                        </div>`;
                    calendarGrid.insertAdjacentHTML('beforeend', dayElement);
                }
            },
            
            renderCourseButtons() {
                const container = document.querySelector('#course-guide-panel .space-y-3');
                if(!container) return;
                
                const courses = [
                    { name: '1° Inicial', color: '#60a5fa' }, { name: '2° Inicial', color: '#f87171' },
                    { name: '3° TIPP', color: '#4ade80' }, { name: '3° MMO', color: '#fbbf24' },
                    { name: '4° TIPP', color: '#4ade80' }, { name: '4° MMO', color: '#fbbf24' },
                    { name: '5° TIPP', color: '#34d399' }, { name: '5° MMO', color: '#f97316' },
                    { name: '6° TIPP', color: '#34d399' }, { name: '6° MMO', color: '#f97316' },
                ];
                
                container.innerHTML = courses.map(course => `
                    <button class="w-full text-left flex items-center p-2 rounded-md hover:bg-gray-100">
                        <span class="w-4 h-4 rounded-full mr-3" style="background-color: ${course.color};"></span>
                        <span class="text-sm font-medium text-gray-700">${course.name}</span>
                    </button>
                `).join('');
            },

            addEventListeners() {
                document.getElementById('role-switcher').addEventListener('change', (e) => {
                    this.state.role = e.target.value;
                    this.render();
                });

                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.switchView(link.dataset.view);
                    });
                });
                
                // Listeners Modal
                document.getElementById('close-modal-btn').addEventListener('click', () => {
                    document.getElementById('event-modal').classList.add('hidden');
                });
                document.getElementById('event-form').addEventListener('submit', (e) => this.saveEvent(e));
            },
            
            addCalendarListeners() {
                 const prevMonthBtn = document.getElementById('prev-month');
                 const nextMonthBtn = document.getElementById('next-month');
                 
                 if(prevMonthBtn) {
                    prevMonthBtn.addEventListener('click', () => {
                        this.state.currentDate.setMonth(this.state.currentDate.getMonth() - 1);
                        this.renderCalendar();
                        this.addCalendarListeners(); // Re-attach listeners for new day elements
                    });
                 }
                 
                 if(nextMonthBtn) {
                    nextMonthBtn.addEventListener('click', () => {
                        this.state.currentDate.setMonth(this.state.currentDate.getMonth() + 1);
                        this.renderCalendar();
                        this.addCalendarListeners(); // Re-attach listeners for new day elements
                    });
                 }
                
                document.querySelectorAll('.calendar-day').forEach(day => {
                   day.addEventListener('click', (e) => this.openEventModal(e.currentTarget.dataset.date));
                });
            },
            
            openEventModal(date) {
                document.getElementById('event-form').reset();
                document.getElementById('event-date').value = date;
                document.getElementById('event-modal').classList.remove('hidden');
                lucide.createIcons();
            },
            
            saveEvent(e) {
                e.preventDefault();
                const date = document.getElementById('event-date').value;
                const title = document.getElementById('event-title').value;
                const course = document.getElementById('event-course').value;
                
                if (!this.state.events[date]) {
                    this.state.events[date] = [];
                }
                this.state.events[date].push({ title, course });

                // Planificador automático: si el evento es para hoy, crear uno para 7 días después
                const today = new Date();
                const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
                if (date === todayStr) {
                    const planningDate = new Date();
                    planningDate.setDate(planningDate.getDate() + 7);
                    const planningDateStr = `${planningDate.getFullYear()}-${String(planningDate.getMonth() + 1).padStart(2, '0')}-${String(planningDate.getDate()).padStart(2, '0')}`;
                    if(!this.state.events[planningDateStr]) this.state.events[planningDateStr] = [];
                    this.state.events[planningDateStr].push({ title: `Planificar: ${title}`, course });
                }

                document.getElementById('event-modal').classList.add('hidden');
                this.renderCalendar();
                this.addCalendarListeners(); // Re-attach listeners after re-rendering calendar
            }
        };

        App.init();

    </script>
</body>
</html>
